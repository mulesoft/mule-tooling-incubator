<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<namespace xmlns="http://www.mulesoft.org/schema/mule/tooling.attributes"
	prefix="mq" url="http://www.mulesoft.org/schema/mule/mq">

	<endpoint inboundLocalName="subscriber" outboundLocalName="publish"
		localId="subscriber-publish" caption="Anypoint MQ" image="icons/large/messaging-48x32.png"
		icon="icons/small/messaging-24x16.png" abstract="false" versions="[3.7.0,10.0.0]"
		metaData="static" paletteCategory="org.mule.tooling.category.cloudconnectors"
		description="The Anypoint MQ Connector provides a single interface for messaging">
		<keywords>
			<keyword value="mq" weight="1" />
			<keyword value="messaging" weight="1" />
			<keyword value="publish" weight="1" />
			<keyword value="subscribe" weight="1" />
			<keyword value="queue" weight="1" />
			<keyword value="fifo" weight="1" />
		</keywords>
		<attribute-category caption="General" description="General properties">

			<group caption="General Settings" id="generalSettings">
				<globalRef caption="Connector Configuration" required="true"
					description="The name of the global configuration to be used."
					requiredType="http://www.mulesoft.org/schema/mule/mq/config" name="config-ref"
					saveAs="config-ref" />
			</group>

			<group caption="Subscriber Settings" id="basicPublishSettings"
				mode="inbound">
				<string caption="Destination"
					description="Destination from where to retrieve messages." name="publish-destination"
					saveAs="destination" mode="inbound" required="true" />

				<enum
					description="Acknowledge mode to use for the messages retrieved from this subscriber."
					name="ackMode" caption="ACK Mode" mode="inbound" defaultValue="AUTO"
					removeEmptyOption="true" allowsCustom="true">
					<option value="NONE" />
					<option value="AUTO" />
					<option value="MANUAL" />
				</enum>
			</group>

			<group caption="Publisher Settings" id="basicSubscriberSettings"
				mode="outbound">
				<string caption="Destination"
					description="Destination from where to retrieve messages." name="subscriber-destination"
					saveAs="destination" mode="outbound" required="true" />

				<childElement name="http://www.mulesoft.org/schema/mule/mq/property"
					description="Properties" caption="Properties" allowMultiple="true"
					inplace="true" mode="outbound" />
			</group>
		</attribute-category>

		<attribute-category description="Prefetch Properties"
			caption="Prefetch" id="prefetchSettings" mode="inbound">

			<radioBoolean fillLine="true" description="No prefetch config is required."
				loadedValueModifier="org.mule.tooling.messaging.editor.global.booleanloaders.PrefetchLoadedValueModifier"
				group="prefetch-config" caption="No Prefetch Config" name="include-nothing" />

			<radioBoolean fillLine="true"
				description="Define a Nested Prefetch Configuration"
				loadedValueModifier="org.mule.tooling.messaging.editor.global.booleanloaders.PrefetchLoadedValueModifier"
				group="prefetch-config" caption="Use Prefetch Config" name="nested" />

			<childElement indented="true" controlled="nested"
				xmlOrder="10"
				valuePersistence="org.mule.tooling.messaging.editor.global.PrefetchValuePersistence"
				inplace="true" name="http://www.mulesoft.org/schema/mule/tls/context" />

			<radioBoolean fillLine="true"
				description="Use a global TLS configuration reference"
				loadedValueModifier="org.mule.tooling.messaging.editor.global.booleanloaders.PrefetchLoadedValueModifier"
				group="prefetch-config" caption="Use Global Prefetch Config" name="reference" />

			<globalRef caption="Prefetch" indented="true" controlled="reference"
				description="Name of the global prefetch configuration to be used."
				requiredType="http://www.mulesoft.org/schema/mule/mq/mqPrefetchType"
				name="prefetch-ref" />

		</attribute-category>
	</endpoint>

	<nested localId="property" versions="[3.7.0,10.0.0]">
		<string name="propertyName" description="The name of the property."
			caption="Name" />
		<string name="value" description="The value of the property."
			caption="Value" />
	</nested>

	<nested localId="access" versions="[3.7.0,10.0.0]">
		<string caption="Broker URL" description="" required="true"
			name="brokerUrl" xsdType="string" />

		<string caption="Client ID"
			description="The Client Identifier to be used to authorize the connection."
			required="true" name="clientId" xsdType="string" />

		<string caption="Client Secret"
			description="The Client Secret to be used to authorize the connection."
			required="true" name="clientSecret" xsdType="string" />
	</nested>

	<global localId="mqAccessType" versions="[3.7.0,10.0.0]"
		xmlname="access" category="org.mule.tooling.globalCategory.conponentConfigurations"
		description="Global Access Configuration" caption="Access Settings"
		image="icons/large/messaging-48x32.png" icon="icons/small/messaging-24x16.png">

		<attribute-category description="General Settings"
			caption="General">
			<group caption="Generic" id="name">
				<name required="true"
					description="Give a name to this access configuration so it can be later referenced by builder ref."
					caption="Name" name="name"></name>
			</group>
			<group caption="Settings" id="accessSettings">
				<string caption="Broker URL" description="" required="true"
					name="brokerUrl" xsdType="string" />

				<string caption="Client ID"
					description="The Client Identifier to be used to authorize the connection."
					required="true" name="clientId" xsdType="string" />

				<string caption="Client Secret"
					description="The Client Secret to be used to authorize the connection."
					required="true" name="clientSecret" xsdType="string" />
			</group>
		</attribute-category>
	</global>

	<nested localId="prefetch" versions="[3.7.0,10.0.0]">
		<long caption="Retrieve Period"
			description="Amount of milliseconds to execute the retrieve operation when the prefetch queue is not empty."
			required="false" name="retrievePeriod" defaultValue="5000"
			xsdType="substitutableLong" />

		<long caption="Min Retrieve Interval"
			description="Minimal amount of milliseconds to wait between retrieve operations. If the prefetch queue is emptied very often, this value avoid executing excessive calls to the broker."
			required="false" name="minRetrieveInterval" defaultValue="1000"
			xsdType="substitutableLong" />
	</nested>

	<global localId="mqPrefetchType" versions="[3.7.0,10.0.0]"
		xmlname="prefetch" category="org.mule.tooling.globalCategory.conponentConfigurations"
		description="Global Prefetch Configuration" caption="Prefetch Settings"
		image="icons/large/messaging-48x32.png" icon="icons/small/messaging-24x16.png">

		<attribute-category description="General Settings"
			caption="General">
			<group caption="Generic" id="name">
				<name required="true"
					description="Give a name to this prefetch configuration so it can be later referenced by builder ref."
					caption="Name" name="name"></name>
			</group>
			<group caption="Settings" id="prefetchSettings">
				<long caption="Retrieve Period"
					description="Amount of milliseconds to execute the retrieve operation when the prefetch queue is not empty."
					required="false" name="retrievePeriod" defaultValue="5000"
					xsdType="substitutableLong" />

				<long caption="Min Retrieve Interval"
					description="Minimal amount of milliseconds to wait between retrieve operations. If the prefetch queue is emptied very often, this value avoid executing excessive calls to the broker."
					required="false" name="minRetrieveInterval" defaultValue="1000"
					xsdType="substitutableLong" />
			</group>
		</attribute-category>
	</global>

	<global-cloud-connector metaData="off"
		usesMetadataTypes="false" connectivityTesting="off" abstract="false"
		image="icons/large/messaging-48x32.png" icon="icons/small/messaging-24x16.png"
		localId="config" description="Configuration information."
		paletteCategory="org.mule.tooling.globalCategory.conponentConfigurations"
		category="org.mule.tooling.globalCategory.cloudconnectors" caption="Anypoint MQ Configuration"
		versions="[3.7.0,10.0.0]">

		<attribute-category description="Anypoint MQ configuration parameters"
			caption="General">
			<group caption="Generic" id="messagingGenericProperties">
				<name required="true"
					description="Give a name to this configuration so it can be later referenced by config-ref."
					caption="Name" name="name">
				</name>
			</group>
			<group caption="Access" id="accessProperties">
				<radioBoolean fillLine="true" description="Define a Nested Access"
					loadedValueModifier="org.mule.tooling.messaging.editor.global.booleanloaders.AccessLoadedValueModifier"
					group="access-listener" caption="Use Access Config" name="nested" />

				<childElement indented="true" controlled="nested"
					xmlOrder="30"
					valuePersistence="org.mule.tooling.messaging.editor.global.AccessValuePersistence"
					inplace="true" name="http://www.mulesoft.org/schema/mule/mq/access" />

				<radioBoolean fillLine="true"
					description="Use a global Access configuration reference"
					loadedValueModifier="org.mule.tooling.messaging.editor.global.booleanloaders.AccessLoadedValueModifier"
					group="access-listener" caption="Use Global Access Config" name="reference" />

				<globalRef caption="Access" indented="true" controlled="reference"
					description="Name of the global Access to be used." requiredType="http://www.mulesoft.org/schema/mule/mq/mqAccessType"
					name="access-ref" />
			</group>
			<group caption="Basic Settings" id="basicSettingsConfigGroup">
				<integer caption="Max Redelivery"
					description="Number of re-deliveries in case of the message processing fails. In order to avoid poisson message, default value is 0."
					defaultValue="0" name="maxRedelivery" xsdType="substitutableInt" />

				<long caption="Pooling Time"
					description="Maximum time in milliseconds to wait for the required amount of messages. If this time is elapsed, the response will be sent with as many messages as taken during the period."
					defaultValue="10000" name="poolingTime" xsdType="substitutableLong" />

				<integer caption="Batch Size"
					description="Number of messages to receive at once when asking for messages. The response could contain less messages than this number depending of the poolingTime set."
					defaultValue="1" name="batchSize" xsdType="substitutableInt" />

				<integer caption="Lock Time to Live"
					description="Time a message will be hold by the broker waiting for an ack or nack. After that time period it will be available again to any subscriber."
					defaultValue="0" name="lockTimeToLive" xsdType="substitutableInt" />

				<boolean description="If true provides a mock configuration to perform testing."
					caption="Mock" name="mock" default="false" />
			</group>
		</attribute-category>
		<attribute-category description="TLS/SSL Properties"
			caption="TLS/SSL" id="tlsSettings">

			<radioBoolean fillLine="true"
				description="For MQ Configuration no TLS config is required."
				loadedValueModifier="org.mule.tooling.messaging.editor.global.booleanloaders.TlsLoadedValueModifier"
				group="tls-listener" caption="No TLS Config" name="include-nothing" />

			<radioBoolean fillLine="true" description="Define a Nested TLS Context"
				loadedValueModifier="org.mule.tooling.messaging.editor.global.booleanloaders.TlsLoadedValueModifier"
				group="tls-listener" caption="Use TLS Config" name="nested" />

			<childElement indented="true" controlled="nested"
				xmlOrder="10"
				valuePersistence="org.mule.tooling.messaging.editor.global.TlsValuePersistence"
				inplace="true" name="http://www.mulesoft.org/schema/mule/tls/context" />

			<radioBoolean fillLine="true"
				description="Use a global TLS configuration reference"
				loadedValueModifier="org.mule.tooling.messaging.editor.global.booleanloaders.TlsLoadedValueModifier"
				group="tls-listener" caption="Use Global TLS Config" name="reference" />

			<globalRef caption="TLS Context" indented="true"
				controlled="reference" description="Name of the global TLS context to be used."
				requiredType="http://www.mulesoft.org/schema/mule/tls/globalContext"
				name="tlsContext-ref" />

		</attribute-category>
		<attribute-category description="Proxy Configuration"
			caption="Proxy" id="proxySettings">

			<radioBoolean fillLine="true" caption="No Proxy Config"
				description="Don't Use a Proxy Configuration"
				loadedValueModifier="org.mule.tooling.rest.consumer.editor.global.booleanloaders.ProxyLoadedValueModifier"
				group="proxy-req" name="none" />

			<radioBoolean caption="Use Proxy Config"
				description="Define an nested Proxy Configuration" group="proxy-req"
				loadedValueModifier="org.mule.tooling.rest.consumer.editor.global.booleanloaders.ProxyLoadedValueModifier"
				name="nested" fillLine="true" />

			<childElement indented="true" controlled="nested"
				valuePersistence="org.mule.tooling.ui.modules.core.widgets.editors.dynamic.DynamicEditorValuesPreProcessor"
				persistenceTransformer="org.mule.tooling.rest.consumer.editor.global.ProxyPersistenceTransformer"
				name="http://www.mulesoft.org/schema/mule/http/proxy-config"
				inplace="true" xmlOrder="50" />

			<childElement visibleInDialog="false" xmlOrder="50"
				name="http://www.mulesoft.org/schema/mule/http/proxy" />

			<childElement visibleInDialog="false" xmlOrder="50"
				name="http://www.mulesoft.org/schema/mule/http/ntlm-proxy" />

			<radioBoolean fillLine="true" caption="Use Global Proxy Config"
				description="Use a global configuration reference"
				loadedValueModifier="org.mule.tooling.rest.consumer.editor.global.booleanloaders.ProxyLoadedValueModifier"
				group="proxy-req" name="reference" />

			<globalRef caption="Proxy Ref" indented="true" controlled="reference"
				description="Name of the global Proxy Configuration to be used."
				requiredType="$http://www.mulesoft.org/schema/mule/http/proxy,http://www.mulesoft.org/schema/mule/http/ntlm-proxy"
				name="proxy-ref" />

		</attribute-category>
	</global-cloud-connector>
</namespace>